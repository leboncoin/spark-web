import { Meta, Canvas, ArgTypes } from '@storybook/addon-docs/blocks'
import { A11yReport } from '@docs/helpers/A11yReport'
import { Callout } from '@docs/helpers/Callout'
import { Avatar } from '.'
import * as stories from './avatar.stories'

<Meta of={stories} />

# Avatar

The Avatar component displays a circular profile image with an optional online status badge and a customizable edit button.

<Canvas of={stories.Default} />

## Install

```sh
npm install @spark-ui/components
```

## Anatomy

```tsx
import { Avatar } from '@spark-ui/components/avatar'

export default () => (
  <Avatar>
    <Avatar.User>
      <Avatar.Image />
      <Avatar.Placeholder />
    </Avatar.User>
    <Avatar.Action />
    <Avatar.OnlineBadge />
  </Avatar>
);
```

## API Reference

### Avatar

Main container for the avatar.

<ArgTypes of={Avatar} />


### _.User

Preview section of the user (either a profile pic or a placeholder)

<ArgTypes of={Avatar.User} />


### _.Image

Component to display the avatar image.

<ArgTypes of={Avatar.Image} />

### _.Placeholder

Placeholder to display in case there is no image or the image is not available.

<ArgTypes of={Avatar.Placeholder} />

### _.OnlineBadge

Badge to display the online status of the user.

<ArgTypes of={Avatar.OnlineBadge} />

### _.Action

Edit button positioned on the avatar border.

<ArgTypes of={Avatar.Action} />

## Examples

### Action

Use the `Avatar.Action` component to display an action button on the avatar.

Use `children` to use a custom icon.

Use the `asChild` prop to replace with a custom element.

We advise using Avatar.Action with the lg and above sizes.

<Canvas of={stories.Actions} />

### As a link

Use the `asChild` on `Avatar.User` prop to turn into a link (or a button).

<Canvas of={stories.AsLink} />

### Custom border

Use tailwind to add a border to the avatar. Rely on the border tokens and use either `surface` or `outline` for the border colors.

<Canvas of={stories.CustomBorder} />

### Online Status

Use the `isOnline` prop to display a badge indicating this user is online.

<Callout kind="warning" marginY="large">
  <p>
    a11y: think about using `onlineText` prop to provide a more accessible way to display the online status.
  </p>
</Callout>

<Canvas of={stories.WithOnlineStatus} />

### Placeholder

Use the `Avatar.Placeholder` to display a placeholder avatar.

By default it will use the first letter of the username, but you can use the `children` prop to display an icon or a custom element.

<Canvas of={stories.Placeholder} />

### Shapes

Use the `design` prop to display a square avatar.

<Canvas of={stories.Shapes} />

### Sizes

The Avatar component comes in 5 different sizes.

<Canvas of={stories.Sizes} />

## Advanced Usage

### Image loading state

When loading avatar images, especially from external sources or when the image source changes dynamically, it's important to provide visual feedback to users. This example demonstrates how to manage the loading state by displaying a spinner in the placeholder while the image is loading. The spinner is shown when an image source is provided and automatically hidden once the image loads successfully or if an error occurs. This provides a better user experience by indicating that content is being loaded rather than showing a broken image or empty state.

<Canvas of={stories.AlternatingImage} />

## Accessibility

<A11yReport of="avatar" />

The Avatar component follows accessibility best practices:

- The avatar image has an `alt` attribute that uses the provided username
- The edit button has an accessible label
- The online status badge uses semantic colors
- Sizes are sufficient to be clickable on mobile 
