import { Meta, Canvas, ArgTypes } from '@storybook/addon-docs/blocks'
import { A11yReport } from '@docs/helpers/A11yReport'
import { Kbd } from '@spark-ui/components/kbd'
import { Callout } from '@docs/helpers/Callout'

import { Slider } from '.'

import * as stories from './Slider.stories'

<Meta of={stories} />

# Slider

An input where the user selects a value from within a given range.

<Canvas of={stories.Default} />

## Install

```sh
npm install @spark-ui/components
```

## Anatomy

```tsx
import { Slider } from '@spark-ui/components/slider'

export default () => (
  <Slider>
    <Slider.Label>Volume</Slider.Label>
    <Slider.Value />

    <Slider.Control>
      <Slider.Track>
        <Slider.Indicator />
        <Slider.Thumb />
      </Slider.Track>
    </Slider.Control>

    <Slider.MinValue />
    <Slider.MaxValue />
  </Slider>
)
```

## API Reference

### Slider

Contains all the slider component parts. It renders a hidden input when used within a form so that the value is submitted with the form.

<ArgTypes of={Slider} />

### \_.Label

The label for the slider. Use it to provide an accessible name for the control.

<ArgTypes of={Slider.Label} />

### \_.Control

The control wrapper that contains the track and its children.

<ArgTypes of={Slider.Control} />

### \_.Track

The track shows the range available for user selection.

<ArgTypes of={Slider.Track} />

### \_.Indicator

The indicator shows the selected range within the track.

<ArgTypes of={Slider.Indicator} />

### \_.Thumb

A draggable thumb. You can render `Slider.Value` as a child of the thumb so the value is displayed in a popover above the thumb (position absolute).

<ArgTypes of={Slider.Thumb} />

### \_.Value

An optional component to display the current value of the slider. When rendered **inside** a `Slider.Thumb`, the value is positioned absolutely above the thumb (like a popover). The optional render prop receives `(formattedValue, value)` when you need to format the display.

<ArgTypes of={Slider.Value} />

### \_.MinValue

An optional component to display the minimum value of the slider range. Positioned below the control on the left side.

<ArgTypes of={Slider.MinValue} />

### \_.MaxValue

An optional component to display the maximum value of the slider range. Positioned below the control on the right side.

<ArgTypes of={Slider.MaxValue} />

## Examples

### Controlled

Use `value` to control the value with your own state.

Use either `onValueChange` or `onValueCommit` to update this state when internal changes happen:

- `onValueChange` Event handler called when the value changes.
- `onValueCommit`: Event handler called when the value changes at the end of an interaction. Useful when you only need to capture a final value e.g. to update a backend service.

<Canvas of={stories.Controlled} />

### Intent

Use `intent` prop to set the color of track and thumb.

<Canvas of={stories.Intent} />

### Value in Thumb

Render `Slider.Value` as a child of `Slider.Thumb` to show the value in a popover above the thumb.

<Canvas of={stories.ThumbWithValue} />

### Disabled

Use `disabled` prop to indicate that slider is disabled.

<Canvas of={stories.Disabled} />

## Advanced Examples

### Restricted values

If you find yourself in a situation where you have a fixed set of values for your range, you can achieve this using the `max` property.
The `max` property should be set to the number of steps you have within your set of values minus one.

Additionally, you will need to remap the value from the **Slider** component to the values comprised in your set of values.

For example, let's say your set of values is `[10, 25, 50, 100]`. In this case, you would set the `max` property to 3 and remap the values from the **Slider**.

The **Slider** component, by default, outputs values from `min` to `max` (3 in our case). Therefore, it's your responsibility to map these values to the corresponding values in your set.

To ensure **proper accessibility**, make sure to set the `aria-valuetext` attribute to the remapped value. This will ensure that the correct value is announced to users who rely on assistive technologies.

Here's an example to illustrate this:

<Canvas of={stories.RestrictedValues} />

## Form field

Slider is fully compatible with `FormField` (label, helper messages, validation, etc.).

<Callout kind="warning" marginY="large">
  <p>
    Slider comes with its own label component, favor that one over `FormField.Label` to add a label
    to the slider.
  </p>
</Callout>

<Canvas of={stories.FormFieldExample} />

## Accessibility

<A11yReport of="slider" />

Adheres to the [Slider (Single Thumb) WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/patterns/slider/).

Implementations should define an `aria-label` attribute on each `Slider.Thumb` to preserve accessibility.

### Keyboard Interactions

- <Kbd>ArrowRight</Kbd>: Increments by the `step` value.
- <Kbd>ArrowLeft</Kbd>: Decrements by the `step` value.
- <Kbd>ArrowUp</Kbd>: Increases the value by the `step` amount.
- <Kbd>ArrowDown</Kbd>: Decreases the value by the `step` amount.
- <Kbd>PageUp</Kbd>: Increases the value by a larger `step`.
- <Kbd>PageDown</Kbd>: Decreases the value by a larger `step`.
- <Kbd>Shift + ArrowUp</Kbd>: Increases the value by a larger `step`.
- <Kbd>Shift + ArrowDown</Kbd>: Decreases the value by a larger `step`.
- <Kbd>Home</Kbd>: Sets the value to its minimum.
- <Kbd>End</Kbd>: Sets the value to its maximum.
