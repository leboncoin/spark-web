import { Meta, Canvas, ArgTypes } from '@storybook/addon-docs/blocks'
import { A11yReport } from '@docs/helpers/A11yReport'
import { Kbd } from '@spark-ui/components/kbd'

import { Drawer } from '.'

import * as stories from './Drawer.stories'

<Meta of={stories} />

# Drawer

A panel that slides out from the edge of the screen. It can be useful when you need users to complete a task or view some details without leaving the current page.

<Canvas of={stories.Usage} />

- ✅ Supports modal and non-modal modes.
- ✅ Focus is automatically trapped when modal.
- ✅ Can be controlled or uncontrolled.
- ✅ Manages screen reader announcements with `Title` and `Description` components.
- ✅ Esc closes the component automatically.

## Install

Install the component from your command line.

```sh
npm install @spark-ui/components
```

## Anatomy

```tsx
import { Drawer } from '@spark-ui/components/drawer'

export default () => (
  <Drawer>
    <Drawer.Trigger />
    <Drawer.Portal>
      <Drawer.Overlay />
      <Drawer.Content>
        <Drawer.Header>
          <Drawer.Title />
        </Drawer.Header>
        <Drawer.Body>
          <Drawer.Description />
        </Drawer.Body>
        <Drawer.Footer>
          <Drawer.Close />
        </Drawer.Footer>
        <Drawer.CloseButton>
      </Drawer.Content>
    </Drawer.Portal>
  </Drawer>
);
```

## API Reference

### Drawer

Contains all the parts of a drawer.

<ArgTypes of={Drawer} />  

### _.Trigger

The button that opens the drawer.

<ArgTypes of={Drawer.Trigger} />


### _.Portal

When used, portals your overlay and content parts into the body.

<ArgTypes of={Drawer.Portal} />


### _.Overlay

A layer that covers the inert portion of the view when the drawer is open.

<ArgTypes of={Drawer.Overlay} />

### _.Content

Contains Header/Body/Footer to be rendered in the open drawer.

<ArgTypes of={Drawer.Content} />

### _.Header

To use inside of Popover.Content. Sticky header inside the drawer.

<ArgTypes of={Drawer.Header} />

### _.Body

To use inside of Popover.Content. Main content of the drawer. Becomes scrollable when content is overflowing the screen.

<ArgTypes of={Drawer.Body} />

### _.Footer

To use inside of Popover.Content. Sticky footer to be rendered in the open drawer. Use it to render CTAs and make them accessible in every condition.

<ArgTypes of={Drawer.Footer} /> 

### _.Close

An abstract button that closes the drawer, meant for usage inside the content to attach closing behavior to.

<ArgTypes of={Drawer.Close} />

### _.CloseButton

An icon button with a cross icon that closes the drawer and is located in the top right corner of the drawer.

<ArgTypes of={Drawer.CloseButton} />


## Examples

### Fade effect

Use `withFade` to add a fade effect to indicate content overflow. It uses an alpha css mask to be compatible no matter wich background is behind your content.

<Canvas of={stories.Fade} />

### Inset

When set to `true`, this option will remove the internal padding of the `Drawer.Body` component. This allows you to have an image or any content that occupies the full width, for example.

<Canvas of={stories.Inset} />

### Side

Pick a side among `right`, `left`, `top` and `bottom`.

<Canvas of={stories.Side} />

### Size

Pick a size among `sm`, `md`, `lg`, `fluid` and `fullscreen`.

<Canvas of={stories.Sizes} />



## Accessibility

<A11yReport of="drawer" />

Adheres to the [Dialog WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/).

### Guidelines

- **Usage of `Drawer.Title` is mandatory**. It serves as the accessible name for the drawer. If you prefer not to display the title, you can wrap it with `VisuallyHidden`.
- **`Drawer.CloseButton` must be rendered as the last child of `Drawer.Content`**. When opening, the drawer forwards the focus to the first interactive element inside of it, it shouldn't be the close button. User can use `Shift + Tab` to easily access the close button after the drawer has been opened.
- Be careful not to overlap content with `Drawer.CloseButton`, which has a large clickable area.

### Keyboard Interactions

- <Kbd>Space</Kbd> - Opens/closes the drawer.
- <Kbd>Enter</Kbd> - Opens/closes the drawer.
- <Kbd>Tab</Kbd> - Moves focus to the next focusable element.
- <Kbd>Shift</Kbd> + <Kbd>Tab</Kbd> - Moves focus to the previous focusable element.
- <Kbd>Esc</Kbd> - Closes the drawer and moves focus to `Drawer.Trigger`.
